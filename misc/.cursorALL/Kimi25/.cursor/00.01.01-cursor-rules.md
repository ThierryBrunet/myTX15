# RC Radio & Aircraft Configuration Rules

## 01.00.00 - Project Overview

This repository manages RadioMaster TX15 configurations using EdgeTX firmware for multiple aircraft types (quadcopters and fixed wings) with ExpressLRS receivers.

### 01.01.00 - Hardware Inventory

#### 01.01.01 - Transmitter
- **Radio**: RadioMaster TX15
- **Firmware**: EdgeTX v2.11.4 (Latest stable for STM32F4 - avoid v2.12.0 RC for production)
- **SD Card Path**: `D:\`
- **Git Repo Path**: `C:\Users\thier\OneDrive\Workspaces\ExpressLRS\RadioMaster_TX15\myTX15\EdgeTX`

#### 01.01.02 - Receivers
1. **Cyclone (AliExpress ELRS 2.4GHz PWM 7CH CRSF)**
   - Config: `7CH.json` or `CRSF.json`
   - Protocol: CRSF

2. **HPXGRC 2.4G ExpressLRS Receiver**
   - Standard ELRS receiver

3. **DarwinFPV F415 AIO Flight Controller**
   - Integrated ELRS 2.4GHz
   - F4 FC + 4-in-1 ESC

#### 01.01.03 - Gyroscopes/Stabilizers
1. **Reflex V3 Flight Controller Gyro Stabilizer**
   - Firmware: www.fmsmodel.com/page/reflex
   - Use for: Fixed wings

2. **ICM-20948 9-Axis MEMS**
   - Better for: Fixed wings

3. **ICM-45686 6-Axis**
   - Better for: Vibration-heavy quads

#### 01.01.04 - Aircraft

**Quadcopters:**
- Angel30 3-inch Carbon Fiber Frame

**Fixed Wings:**
- Flying Bear Fx707s (foam conversion)
- 50CM Big Foam Plane (foam conversion)
- EDGE540 EPP F3P (flat foamy)

### 01.02.00 - Software Versions

| Software | Version | Notes |
|----------|---------|-------|
| EdgeTX | v2.11.4 | Latest stable for TX15 (STM32F4) |
| ExpressLRS | v3.5.4 | Latest stable (avoid 4.0.0 RC) |
| ELRS Configurator | Latest | For flashing receivers |
| EdgeTX Companion | v2.11.4 | Match firmware version |

### 01.03.00 - Safety Requirements

#### 01.03.01 - Arming Safety (Quadcopters)
- **2-step arming** required for all quads
- Step 1: Throttle must be at minimum (0%)
- Step 2: Arm switch activation
- DarwinFPV F415 supports: `ARM` mode in Betaflight
- Use Logical Switch: `L01` = AND(Switch Arm, Throttle < -95%)

#### 01.03.02 - Arming Safety (Fixed Wings)
- **2-step arming** without using Channel 5
- Use Channel 6 or higher for arming
- Throttle cutoff mandatory
- Reflex V3 integration for flight modes

#### 01.03.03 - Throttle Safety
- All models must have throttle cut on disarm
- Pre-flight throttle check enabled
- Custom position: -100% (0% throttle)

## 02.00.00 - Configuration Standards

### 02.01.00 - Model Naming Convention

```
[TYPE]_[AIRCRAFT]_[RECEIVER]_[CONFIG]

Examples:
- QUAD_Angel30_Cyclone_Indoor
- QUAD_Angel30_Cyclone_Outdoor
- QUAD_Angel30_Cyclone_Normal
- FW_Fx707s_Reflex_Beginner
- FW_Fx707s_Reflex_Advanced
- FW_Fx707s_Reflex_Manual
```

### 02.02.00 - Flight Configurations

#### 02.02.01 - Quadcopter Flight Modes (Betaflight)

**Indoor Mode:**
- Roll/Pitch rate: 50% (RC Rate 0.5)
- Yaw rate: 50%
- Throttle curve: Soft
- Angle mode enabled
- Motor output limit: 70%

**Outdoor Mode:**
- Roll/Pitch rate: 70% (RC Rate 0.7)
- Yaw rate: 70%
- Throttle curve: Linear
- Angle/Horizon mode
- Motor output limit: 85%

**Normal Mode:**
- Full Betaflight passthrough
- Rates as configured in Betaflight
- Acro mode default
- 100% motor output

#### 02.02.02 - Fixed Wing Flight Modes (Reflex V3)

**Beginner Mode:**
- Gyro: Full stabilization (6-axis)
- Bank angle limit: 45°
- Gain: High (80%)
- Channel mapping: CH6 = Mode switch

**Advanced Mode:**
- Gyro: Rate mode (3-axis)
- Bank angle limit: 75°
- Gain: Medium (50%)
- Channel mapping: CH6 = Mode switch

**Full Manual Mode:**
- Gyro: Off (pass-through)
- Direct control
- Channel mapping: CH6 = Mode switch

### 02.03.00 - Mode2 to Mode4 Switch Configuration

Per EdgeTX best practices (youtube.com/watch?v=kiKQy736huM):

**Implementation:**
- Use Global Variable `GV1` to store mode state (0=Mode2, 1=Mode4)
- Physical switch: `SA` (3-pos) or `SE` (2-pos)
- Logical switches adjust stick mappings based on GV1 value

**Mode2 (Default):**
- Left stick: Throttle (CH3) + Yaw (CH4)
- Right stick: Pitch (CH2) + Roll (CH1)

**Mode4 (Alternative):**
- Left stick: Throttle (CH3) + Roll (CH1)
- Right stick: Pitch (CH2) + Yaw (CH4)

**Configuration Steps:**
1. Create Global Variable `GV1` (range 0-1)
2. Create Special Function: Switch X → Adjust GV1 (0 or 1)
3. In Mixes: Use REPLACE multiplex with condition based on GV1
4. Channel 1 (Roll): Source = Ail if GV1=0, else Rud
5. Channel 4 (Yaw): Source = Rud if GV1=0, else Ail

## 03.00.00 - File Organization

### 03.01.00 - EdgeTX SD Card Structure

```
D:\
├── MODELS/                 # Model YAML files
│   ├── QUAD_Angel30.yml
│   ├── FW_Fx707s.yml
│   └── ...
├── RADIO/                  # Radio settings
│   ├── radio.yml
│   └── models.txt
├── SCRIPTS/                # Lua scripts
│   ├── Tools/
│   │   └── elrs.lua        # ExpressLRS configuration
│   └── Mixes/
├── SOUNDS/                 # Audio files
│   ├── en/
│   └── system/
├── IMAGES/                 # Model images (64x32 BMP)
├── WIZARD/                 # Model wizards
├── LAYOUTS/                # Widget layouts
└── LOGS/                   # Telemetry logs
```

### 03.02.00 - Git Repository Structure

```
RadioMaster_TX15/
├── myTX15/
│   ├── EdgeTX/             # Synced with D:\ SD card
│   │   ├── MODELS/
│   │   ├── RADIO/
│   │   ├── SCRIPTS/
│   │   └── SOUNDS/
│   └── Backups/            # Versioned backups
├── Receivers/
│   ├── Cyclone/
│   │   ├── 7CH.json
│   │   └── CRSF.json
│   ├── HPXGRC/
│   └── DarwinFPV/
├── Documentation/
│   ├── Aircraft/
│   ├── Receivers/
│   └── Gyros/
└── Tools/
    └── PowerShell/
```

## 04.00.00 - Synchronization Rules

### 04.01.00 - Sync Modes

| Mode | Direction | Delete Missing | Use Case |
|------|-----------|----------------|----------|
| SyncToRadio | Git → SD | No | Deploy new configs safely |
| SyncFromRadio | SD → Git | No | Backup without deletion |
| MirrorToRadio | Git → SD | Yes | Force Git state to radio |
| MirrorFromRadio | SD → Git | Yes | Force radio state to Git |

### 04.02.00 - Pre-Sync Checklist

1. Close EdgeTX Companion
2. Ensure radio is in bootloader mode (if flashing)
3. Verify SD card mounted at D:\
4. Check git status for uncommitted changes
5. Create backup before Mirror operations

### 04.03.00 - Post-Sync Verification

1. Check model count matches expected
2. Verify radio.yml integrity
3. Test critical models in Companion simulator
4. Validate YAML syntax (no tabs, proper indentation)

## 05.00.00 - Safety Checklists

### 05.01.00 - Pre-Flight (All Aircraft)

- [ ] Model name matches aircraft
- [ ] Battery voltage check
- [ ] Control surfaces/rotors free movement
- [ ] Range check completed
- [ ] GPS lock (if equipped)
- [ ] Video signal clear (FPV)
- [ ] Throttle cut engaged
- [ ] Arm switch in DISARM position

### 05.02.00 - Pre-Flight (Quadcopters)

- [ ] Props removed for bench testing
- [ ] Betaflight config verified
- [ ] Motor direction correct
- [ ] Turtle mode disabled (beginners)
- [ ] Airmode enabled (outdoor/normal)
- [ ] failsafe tested

### 05.03.00 - Pre-Flight (Fixed Wings)

- [ ] Control surfaces centered
- [ ] Reflex V3 mode verified
- [ ] CG check passed
- [ ] Control throws appropriate for mode
- [ ] Launch method confirmed

## 06.00.00 - Troubleshooting

### 06.01.00 - Common Issues

**ELRS not binding:**
- Check version match (TX vs RX)
- Verify binding phrase identical
- Try 500Hz packet rate for initial bind

**No PWM output on Cyclone:**
- Verify 7CH.json vs CRSF.json selection
- Check servo voltage jumper

**Reflex V3 not responding:**
- Re-flash firmware from FMS website
- Verify CH6 input signal
- Check gain settings

**Mode switch not working:**
- Verify GV1 range (0-1)
- Check logical switch logic
- Test in Companion simulator

## 07.00.00 - References

- EdgeTX Manual: https://manual.edgetx.org
- ExpressLRS Docs: https://www.expresslrs.org
- RadioMaster TX15 Downloads: https://radiomasterrc.com/pages/tx15-downloads
- Reflex V3 Firmware: http://www.fmsmodel.com/page/reflex
